<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos</title>
</head>
<body>
    <form id="formPedido">
        <!--ID do cliente-->
        <label for="id_cliente">ID do cliente:</label>
        <input type="number" id="id_cliente" name="id_cliente" required>
        <!--ID da pizza-->
        <label for="id_pizza">ID da pizza:</label>
        <input type="number" id="id_pizza" name="id_pizza" required>
        <!--Quantidade-->
        <label for="quantidade">Quantidade:</label>
        <input type="number" id="quantidade" name="quantidade" required>
        <!--Situação-->
        <label for="situacao">Situação:</label>
        <select id="situacao" name="situacao" required>
            <option value="ativo">Ativo</option>
            <option value="inativo">Inativo</option>
        </select> 
        <!--Valor Total (preço)-->
        <label for="valor_total">Valor total:</label>
        <input type="number" id="valor_total" name="valor_total">
        <!--Forma de pagamento-->
        <label for="forma_de_pagamento">Forma de pagamento:</label>
        <input type="number" id="forma_de_pagamento" name="forma_de_pagamento">
        <!--Data  hora da entrega-->
        <label for="data_tempo">Data e hora da entrega:</label>
        <input type="datetime-local" id="data_tempo" name="data_tempo">
        <!--Botão-->
        <button type="submit">Fazer pedido</button>
        
        <script>
            document.getElementById("formPedido").addEventListener("submit", async(e) =>{
                e.preventDefault();         // Impedirá o envio do formulário.
                // Constantes
                const id_cliente = document.getElementById("id_cliente").value;
                const id_pizza = document.getElementById("id_pizza").value;
                const quantidade = document.getElementById("quantidade").value;
                const situacao = document.getElementById("situacao").value;
                const valor_total = document.getElementById("valor_total").value;
                const forma_de_pagamento = document.getElementById("forma_de_pagamento").value;
                const data_tempo = document.getElementById("data_tempo").value;
                // Try e Catch
                try{
                    const resp = await fetch("http://localhost:3000/pedidos", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            id_cliente,
                            id_pizza,
                            quantidade,
                            situacao,
                            valor_total,
                            forma_de_pagamento,
                            data_tempo
                        })
                    });
                    // Constante data (dado)
                    const data = await resp.json();
                    // condição
                    if(resp.ok){
                        alert("Pedido realizado com sucesso! ID do pedido: " + data.id);
                    }
                }catch(err){
                    console.log(err);
                    alert("Erro ao comunicar com o servidor.");
                }
            });
        </script>
    </form>
</body>
</html>